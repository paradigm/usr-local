#!/bin/sh
COMMAND='echo'
if which upcoming >/dev/null && [ -r ~/.upcoming/upcoming ]
then
	COMMAND=$COMMAND' $(upcoming ~/.upcoming/upcoming)'
fi
if [ "$(uname -n)" = "am" ] && [ -r /sys/devices/platform/thinkpad_hwmon/fan1_input ]
then
	COMMAND=$COMMAND' $(cat /sys/devices/platform/thinkpad_hwmon/fan1_input)'
fi
COMMAND=$COMMAND' $(cat /dev/shm/.$(whoami)-newmail 2>/dev/null)'

if [ -d /sys/class/power_supply/BAT0 ] && which bat >/dev/null
then
	COMMAND=$COMMAND' $(bat)'
fi
COMMAND=$COMMAND' $(date +%a-%Y-%m-%d-%H%M)'
xsetroot -name "$(eval $COMMAND)"
while [ $(date +%S) -ne 0 ]
do
	sleep 1
done
while true
do
	xsetroot -name "$(eval $COMMAND)"
	sleep 60
done
